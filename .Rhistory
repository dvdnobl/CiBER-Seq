library(tidyverse)
library(DESeq2)
his4_raw_counts <- read.delim("data/all_his4_moreseq_counts.txt")
View(his4_raw_counts)
pgk1_raw_counts <- read.delim("data/all_pgk1_moreseq_counts.txt")
View(his4_raw_counts)
View(his4_raw_counts)
## Reading in count tables
his4_raw_counts <- read.delim("data/all_his4_moreseq_counts.txt")[,c(1,6,7,8,9)]
pgk1_raw_counts <- read.delim("data/all_pgk1_moreseq_counts.txt")[,c(1,6,7,8,9)]
his4 <- read.delim("all_his4_moreseq_counts.txt",
stringsAsFactors=FALSE)
## Reading in count tables, extracting RNA count columns
his4_raw_counts <- read.delim("data/all_his4_moreseq_counts.txt")[,c(1,8,9,6,7)]
colnames(his4_raw_counts) <- sub("_L008_R1_001his4.count.txt", "", colnames(his4_raw_counts))
## Changing column names
colnames(his4_raw_counts) <- sub("RNA_", "", colnames(his4_raw_counts))
## Changing column names
colnames(his4_raw_counts)
## Reading in count tables, extracting RNA count columns
his4_raw_counts <- read.delim("data/all_his4_moreseq_counts.txt")[,c(1,8,9,6,7)]
## Changing column names
colnames(his4_raw_counts)
colnames(his4_raw_counts) <- c("barcode", "PreL", "PreR", "PostL", "PostR")
colnames(his4_raw_counts)
head(his4_raw_counts)
## Creating meta table
his4_meta <- data.frame("sampletype" = colnames(his4_raw_counts)[2:5])
View(his4_meta)
## Creating meta table
his4_meta <- data.frame("sampletype" = colnames(his4_raw_counts)[2:5],
"guide_induction" = c("pre", "pre", "post", "post"))
View(his4_meta)
write.table(his4_meta, "meta/his4_meta")
test <- read.delim("meta/his4_meta")
View(test)
write.table(his4_meta, "meta/his4_meta.txt")
write.table(his4_meta, "meta/his4_meta.txt", sep="\t")
test <- read.delim("meta/his4_meta")
test <- read.delim("meta/his4_meta.txt")
View(test)
library(tidyverse)
library(DESeq2)
## Reading in count tables, extracting RNA count columns
his4_raw_counts <- read.delim("data/all_his4_moreseq_counts.txt")[,c(1,8,9,6,7)]
## Changing column names
colnames(his4_raw_counts)
colnames(his4_raw_counts) <- c("barcode", "PreL", "PreR", "PostL", "PostR")
head(his4_raw_counts)
## Creating meta table
his4_meta <- data.frame("sampletype" = colnames(his4_raw_counts)[2:5],
"guide_induction" = c("pre", "pre", "post", "post"))
write.table(his4_meta, "meta/his4_meta.txt", sep="\t")
ggplot(his4_raw_counts) +
geom_histogram(aes(x=PostL), stat="bin") +
xlab("Raw expression counts") +
ylab("Number of genes")
ggplot(his4_raw_counts) +
geom_histogram(aes(x=PostL), stat="bin", bins=200) +
xlab("Raw expression counts") +
ylab("Number of genes")
ggplot(his4_raw_counts) +
geom_histogram(aes(x=PostR), stat="bin", bins=200) +
xlab("Raw expression counts") +
ylab("Number of genes")
ggplot(his4_raw_counts) +
geom_histogram(aes(x=PreR), stat="bin", bins=200) +
xlab("Raw expression counts") +
ylab("Number of genes")
View(his4_raw_counts)
## Visualizing mean vs. variance in data
mean_counts <- apply(his4_raw_counts[,4:5], 1, mean)
var_counts <- apply(his4_raw_counts[,4:5], 1, var)
mean_vs_var <- df(mean_counts, var_counts)
mean_vs_var <- data.frame(mean_counts, var_counts)
View(mean_vs_var)
ggplot(mean_vs_var) +
geom_point(aes(x=mean_counts, y=var_counts)) +
geom_line(aes(x=mean_counts, y=mean_counts, color='blue'))
ggplot(mean_vs_var) +
geom_point(aes(x=mean_counts, y=var_counts)) +
geom_line(aes(x=mean_counts, y=mean_counts, color='blue'))
ggplot(mean_vs_var) +
geom_point(aes(x=mean_counts, y=var_counts)) +
geom_line(aes(x=mean_counts, y=mean_counts, color='blue'))
mean_vs_var <- data.frame(mean_counts, var_counts)
ggplot(mean_vs_var) +
geom_point(aes(x=mean_counts, y=var_counts)) +
geom_line(aes(x=mean_counts, y=mean_counts), color="blue") +
scale_y_log10() +
scale_x_log10()
ggplot(mean_vs_var) +
geom_point(aes(x=mean_counts, y=var_counts)) +
geom_line(aes(x=mean_counts, y=mean_counts), color="blue")
pgk1_raw_counts <- read.delim("data/all_pgk1_moreseq_counts.txt")[,c(1,8,9,6,7)]
View(pgk1_raw_counts)
colnames(pgk1_raw_counts)
colnames(pgk1_raw_counts) <- c("barcode", "PreL", "PreR", "PostL", "PostR")
head(his4_raw_counts)
head(pgk1_raw_counts)
pgk1_meta <- data.frame("sampletype" = colnames(pgk1_raw_counts)[2:5],
"guide_induction" = c("pre", "pre", "post", "post"))
write.table(pgk1_meta, "meta'pgk1_meta.txt", sep="\t")
## Visualizing distribution of expression counts
ggplot(pgk1_raw_counts) +
geom_histogram(aes(x=PostL), stat="bin", bins=200) +
xlab("Raw expression counts") +
ylab("Number of genes")
## Visualizing distribution of expression counts
ggplot(his4_raw_counts) +
geom_histogram(aes(x=PostL), stat="bin", bins=200) +
xlab("Raw expression counts") +
ylab("Number of genes")
## Visualizing mean vs. variance in data
his4_mean_counts <- apply(his4_raw_counts[,4:5], 1, mean)
his4_var_counts <- apply(his4_raw_counts[,4:5], 1, var)
his4_mean_vs_var <- data.frame(his4_mean_counts, his4_var_counts)
## Visualizing mean vs. variance in data
his4_mean_counts <- apply(his4_raw_counts[,4:5], 1, mean)
his4_var_counts <- apply(his4_raw_counts[,4:5], 1, var)
his4_mean_vs_var <- data.frame(his4_mean_counts, his4_var_counts)
pgk1_mean_counts <- apply(pgk1_raw_counts[,4:5], 1, mean)
pgk1_var_counts <- apply(pgk1_raw_counts[,4:5], 1, var)
pgk1_mean_vs_var <- data.frame(pgk1_mean_counts, his4_var_counts)
pgk1_mean_vs_var <- data.frame(pgk1_mean_counts, pgk1_var_counts)
ggplot(his4_mean_vs_var) +
geom_point(aes(x=his4_mean_counts, y=his4_var_counts)) +
geom_line(aes(x=his4_mean_counts, y=his4_mean_counts), color="blue")
ggplot(his4_mean_vs_var) +
geom_point(aes(x=his4_mean_counts, y=his4_var_counts)) +
geom_line(aes(x=his4_mean_counts, y=his4_mean_counts), color="blue") +
scale_y_log10()
ggplot(his4_mean_vs_var) +
geom_point(aes(x=his4_mean_counts, y=his4_var_counts)) +
geom_line(aes(x=his4_mean_counts, y=his4_mean_counts), color="blue") +
scale_y_log10() +
scale_x_log10()
ggplot(pgk1_mean_vs_var) +
geom_point(aes(x=pgk1_mean_counts, y=pgk1_var_counts)) +
geom_line(aes(x=pgk1_mean_counts, y=pgk1_mean_counts), color="green") +
scale_y_log10() +
scale_x_log10()
## Visualizing mean vs. variance in data
his4_mean_counts <- apply(his4_raw_counts[,2:3], 1, mean)
his4_var_counts <- apply(his4_raw_counts[,2:3], 1, var)
his4_mean_vs_var <- data.frame(his4_mean_counts, his4_var_counts)
pgk1_mean_counts <- apply(pgk1_raw_counts[,2:3], 1, mean)
pgk1_var_counts <- apply(pgk1_raw_counts[,2:3], 1, var)
pgk1_mean_vs_var <- data.frame(pgk1_mean_counts, pgk1_var_counts)
ggplot(his4_mean_vs_var) +
geom_point(aes(x=his4_mean_counts, y=his4_var_counts)) +
geom_line(aes(x=his4_mean_counts, y=his4_mean_counts), color="blue") +
scale_y_log10() +
scale_x_log10()
## Visualizing mean vs. variance in data
his4_mean_counts <- apply(his4_raw_counts[,4:5], 1, mean)
his4_var_counts <- apply(his4_raw_counts[,4:5], 1, var)
his4_mean_vs_var <- data.frame(his4_mean_counts, his4_var_counts)
pgk1_mean_counts <- apply(pgk1_raw_counts[,4:5], 1, mean)
pgk1_var_counts <- apply(pgk1_raw_counts[,4:5], 1, var)
pgk1_mean_vs_var <- data.frame(pgk1_mean_counts, pgk1_var_counts)
View(his4_raw_counts)
class(his4_meta$sampletype)
class(factor(his4_meta$sampletype))
is.factor(his4_meta$sampletype)
